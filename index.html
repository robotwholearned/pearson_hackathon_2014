<html>
<head>
<title>Pearson Hackathon 2014</title>
  <script src="js/three.min.js"></script>
  <script src="js/headtrackr.js"></script>
  <link rel="stylesheet" type="text/css" href="styles.css">
</head>
<body>
  

  <canvas id="inputCanvas" width="320" height="240" style="display:none"></canvas>
  <video id="inputVideo" autoplay loop></video>
  <canvas id="debug" width="320" height="240"></canvas>
  
  <div id="character"></div>

  <script type="text/javascript"> 
    //need a camera, a scene, and a renderer 
    var scene = new THREE.Scene();
    var camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
    //renderer: 
    var renderer = new THREE.WebGLRenderer();
    renderer.setSize(window.innerWidth * 0.8, window.innerHeight * 0.8);
    document.body.appendChild(renderer.domElement);

    //add multi cube 
    var geometryColored = new THREE.BoxGeometry(1, 1, 1);
    for (var index = 0; index < geometryColored.faces.length; index++) {
        geometryColored.faces[index].color.setHex(Math.random() * 0xffffff);
        console.log(geometryColored.faces[index].color);
    }
    var materialColored = new THREE.MeshBasicMaterial({ color: 0xffffff, vertexColors: THREE.FaceColors });
    var coloredCube = new THREE.Mesh(geometryColored, materialColored);
    coloredCube.position.set(-1.5, 0.0, 0.0);
    scene.add(coloredCube);

    var videoInput = document.getElementById('inputVideo');
    var canvasInput = document.getElementById('inputCanvas');
    var debugOverlay = document.getElementById('debug');
    //var htracker = new headtrackr.Tracker(debug: debugOverlay);
    var htracker = new headtrackr.Tracker({calcAngles : true, ui : false, headPosition : false, debug : debugOverlay});
    htracker.init(videoInput, canvasInput);
    htracker.start();

    htracker.addEventListener("found", function (event) {
        coloredCube.rotationZ(event.angle)
            .positionX(event.x).positionY(event.y)
            .scaleX(event.width).scaleY(event.height);
    });
    function render() {
        requestAnimationFrame(render);
        renderer.render(scene, camera);
    }
    render();
  </script> 
</body> 
</html>